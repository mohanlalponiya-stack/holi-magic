<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Holi AI Magic Pro | ‡§ú‡§æ‡§¶‡•Å‡§à ‡§π‡•ã‡§≤‡•Ä ‡§â‡§§‡•ç‡§∏‡§µ 2026</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & Babel -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;900&display=swap');
        
        :root {
            --primary: #ff0080;
            --secondary: #7928ca;
            --accent: #ff8c00;
        }

        body { 
            font-family: 'Outfit', sans-serif; 
            background: #020202; 
            color: white; 
            margin: 0; 
            overflow-x: hidden;
        }

        /* ‡§è‡§®‡§ø‡§Æ‡•á‡§ü‡•á‡§° ‡§¨‡•à‡§ï‡§ó‡•ç‡§∞‡§æ‡§â‡§Ç‡§° ‡§Æ‡•á‡§∂ */
        .bg-mesh {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle at 15% 15%, rgba(255, 0, 128, 0.2) 0%, transparent 40%),
                        radial-gradient(circle at 85% 85%, rgba(121, 40, 202, 0.2) 0%, transparent 40%),
                        radial-gradient(circle at 50% 50%, rgba(255, 140, 0, 0.1) 0%, transparent 60%);
            z-index: -1;
        }

        .glass-panel {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .text-gradient {
            background: linear-gradient(to right, #ff0080, #ff8c00, #7928ca);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* ‡§™‡•ç‡§∞‡•Ä‡§Æ‡§ø‡§Ø‡§Æ ‡§Æ‡•à‡§ú‡§ø‡§ï ‡§´‡•ç‡§∞‡•á‡§Æ ‡§°‡§ø‡§ú‡§º‡§æ‡§á‡§® */
        .magic-frame {
            position: relative;
            padding: 14px;
            background: linear-gradient(45deg, #ff0080, #ff8c00, #7928ca, #ff0080);
            background-size: 300% 300%;
            border-radius: 2.5rem;
            box-shadow: 0 0 60px rgba(255, 0, 128, 0.4);
            animation: borderRotate 8s linear infinite;
        }
        
        @keyframes borderRotate {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .magic-frame::before {
            content: '';
            position: absolute;
            inset: 7px;
            background: #080808;
            border-radius: 2.1rem;
            z-index: 0;
        }

        .frame-content {
            position: relative;
            z-index: 1;
            overflow: hidden;
            border-radius: 2rem;
        }

        .loader {
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-top: 4px solid #ff0080;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        .btn-glow:hover {
            box-shadow: 0 0 35px rgba(255, 0, 128, 0.7);
            transform: scale(1.03);
        }

        .ai-message-box {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 0, 128, 0.3);
            border-radius: 1.5rem;
            padding: 1.5rem;
            margin-top: 1rem;
            box-shadow: inset 0 0 20px rgba(255, 0, 128, 0.1);
        }

        /* ‡§è‡§®‡•Ä‡§Æ‡•á‡§∂‡§® ‡§´‡•â‡§∞ ‡§∞‡§ø‡§ú‡§≤‡•ç‡§ü‡•ç‡§∏ */
        .fade-up {
            animation: fadeUp 0.8s ease-out forwards;
        }
        @keyframes fadeUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <div class="bg-mesh"></div>
    <div id="root">
        <div style="display: flex; flex-direction: column; justify-content: center; align-items: center; height: 100vh;">
            <div class="loader"></div>
            <p style="color: white; font-family: 'Outfit', sans-serif; margin-top: 20px; font-weight: 600; letter-spacing: 2px;">HOLI AI MAGIC PRO ‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</p>
        </div>
    </div>

    <script type="text/babel">
        const { useState, useRef, useEffect } = React;

        const App = () => {
            const [originalImage, setOriginalImage] = useState(null);
            const [processedImage, setProcessedImage] = useState(null);
            const [isProcessing, setIsProcessing] = useState(false);
            const [isGeneratingText, setIsGeneratingText] = useState(false);
            const [generatedWishes, setGeneratedWishes] = useState("");
            const [error, setError] = useState(null);
            const [scrolled, setScrolled] = useState(false);
            const [isSpeaking, setIsSpeaking] = useState(false);
            
            const fileInputRef = useRef(null);
            const editorRef = useRef(null);

            // ‡§Ü‡§™‡§ï‡•Ä ‡§Ö‡§™‡§°‡•á‡§ü‡•á‡§° API Key
            const apiKey = "AIzaSyAANL2Y0-o6mRWbi19PfxRoMVWFnpYsNug"; 

            // Exponential backoff ‡§ï‡•á ‡§∏‡§æ‡§• API ‡§ï‡•â‡§≤ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§π‡•á‡§≤‡•ç‡§™‡§∞
            const fetchWithRetry = async (url, options, maxRetries = 5) => {
                let delay = 1000;
                for (let i = 0; i < maxRetries; i++) {
                    try {
                        const response = await fetch(url, options);
                        if (response.ok) return response;
                        if (response.status !== 429 && response.status < 500) {
                            const errData = await response.json();
                            throw new Error(errData.error?.message || "‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§è‡§∞‡§∞");
                        }
                    } catch (e) {
                        if (i === maxRetries - 1) throw e;
                    }
                    await new Promise(resolve => setTimeout(resolve, delay));
                    delay *= 2;
                }
                throw new Error("‡§®‡•á‡§ü‡§µ‡§∞‡•ç‡§ï ‡§ß‡•Ä‡§Æ‡§æ ‡§π‡•à, ‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡•Å‡§®‡§É ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç");
            };

            useEffect(() => {
                const handleScroll = () => setScrolled(window.scrollY > 50);
                window.addEventListener('scroll', handleScroll);
                return () => window.removeEventListener('scroll', handleScroll);
            }, []);

            // ‡§´‡•Ä‡§ö‡§∞ 1: ‡§á‡§Æ‡•á‡§ú ‡§è‡§°‡§ø‡§ü‡§ø‡§Ç‡§ó - ‡§∂‡§ï‡•ç‡§§‡§ø‡§∂‡§æ‡§≤‡•Ä ‡§™‡•ç‡§∞‡•â‡§Æ‡•ç‡§™‡•ç‡§ü ‡§ï‡•á ‡§∏‡§æ‡§•
            const applyHoliTransformation = async (imageUri) => {
                setIsProcessing(true);
                setError(null);
                const base64Data = imageUri.split(',')[1];
                
                const prompt = "Perform a professional Holi festival makeover on this photo. Apply thick, vibrant organic gulal powder colors (neon pink, bright yellow, cyan, and deep purple) onto the person's face, neck, hair, and clothes in a joyful splatter pattern. COMPLETELY REPLACE the current background with a sunny, cinematic Holi festival scene featuring colorful powder explosions, bright atmospheric bokeh, and a blurred festive celebration crowd. High saturation, festive lighting, 8k resolution, realistic textures.";

                try {
                    const response = await fetchWithRetry(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-image-preview:generateContent?key=${apiKey}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            contents: [{
                                parts: [
                                    { text: prompt },
                                    { inlineData: { mimeType: "image/png", data: base64Data } }
                                ]
                            }],
                            generationConfig: { 
                                responseModalities: ['TEXT', 'IMAGE']
                            }
                        })
                    });

                    const data = await response.json();
                    const base64 = data.candidates?.[0]?.content?.parts?.find(p => p.inlineData)?.inlineData?.data;
                    
                    if (base64) {
                        setProcessedImage(`data:image/png;base64,${base64}`);
                        setTimeout(() => editorRef.current?.scrollIntoView({ behavior: 'smooth' }), 500);
                    } else {
                        throw new Error("‡§è‡§Ü‡§à ‡§´‡•ã‡§ü‡•ã ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞ ‡§∏‡§ï‡§æ‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§´‡§ø‡§∞ ‡§∏‡•á ‡§ï‡•ã‡§∂‡§ø‡§∂ ‡§ï‡§∞‡•á‡§Ç‡•§");
                    }
                } catch (err) {
                    setError("‚ö†Ô∏è " + err.message);
                } finally {
                    setIsProcessing(false);
                }
            };

            // ‡§´‡•Ä‡§ö‡§∞ 2: ‡§è‡§Ü‡§à ‡§π‡•ã‡§≤‡•Ä ‡§∂‡§æ‡§Ø‡§∞‡•Ä/‡§∂‡•Å‡§≠‡§ï‡§æ‡§Æ‡§®‡§æ‡§è‡§Ç
            const generateHoliShayari = async () => {
                setIsGeneratingText(true);
                setGeneratedWishes("");

                const prompt = "Generate a very beautiful and creative 4-line Holi Shayari in Hindi. It should be warm, cheerful, and full of love. Only return the text of the shayari.";

                try {
                    const response = await fetchWithRetry(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            contents: [{ parts: [{ text: prompt }] }],
                            systemInstruction: { parts: [{ text: "You are a master Hindi poet specialized in Indian festivals." }] }
                        })
                    });

                    const result = await response.json();
                    const text = result.candidates?.[0]?.content?.parts?.[0]?.text;
                    setGeneratedWishes(text || "‡§π‡•ã‡§≤‡•Ä ‡§ï‡•á ‡§∞‡§Ç‡§ó‡•ã‡§Ç ‡§ï‡•Ä ‡§¨‡•å‡§õ‡§æ‡§∞, ‡§Æ‡•Å‡§¨‡§æ‡§∞‡§ï ‡§π‡•ã ‡§Ü‡§™‡§ï‡•ã ‡§ñ‡•Å‡§∂‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡§æ ‡§§‡•ç‡§Ø‡•ã‡§π‡§æ‡§∞!");
                } catch (err) {
                    setGeneratedWishes("‡§∞‡§Ç‡§ó‡•ã‡§Ç ‡§ï‡•Ä ‡§π‡•ã ‡§≠‡§∞‡§Æ‡§æ‡§∞, ‡§ñ‡•Å‡§∂‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•Ä ‡§π‡•ã ‡§´‡•Å‡§π‡§æ‡§∞, ‡§Æ‡•Å‡§¨‡§æ‡§∞‡§ï ‡§π‡•ã ‡§Ü‡§™‡§ï‡•ã ‡§π‡•ã‡§≤‡•Ä ‡§ï‡§æ ‡§§‡•ç‡§Ø‡•å‡§π‡§æ‡§∞!");
                } finally {
                    setIsGeneratingText(false);
                }
            };

            // ‡§´‡•Ä‡§ö‡§∞ 3: ‡§è‡§Ü‡§à ‡§µ‡•â‡§Ø‡§∏ ‡§µ‡§ø‡§∂ (TTS)
            const playVoiceWish = async () => {
                if (!generatedWishes || isSpeaking) return;
                setIsSpeaking(true);

                try {
                    const response = await fetchWithRetry(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-tts:generateContent?key=${apiKey}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            contents: [{ parts: [{ text: `Say cheerfully in Hindi: ${generatedWishes}` }] }],
                            generationConfig: { 
                                responseModalities: ["AUDIO"], 
                                speechConfig: { voiceConfig: { prebuiltVoiceConfig: { voiceName: "Aoede" } } } 
                            },
                            model: "gemini-2.5-flash-preview-tts"
                        })
                    });

                    const result = await response.json();
                    const pcmData = result.candidates[0].content.parts[0].inlineData.data;
                    
                    const wavBlob = pcmToWav(pcmData, 24000); 
                    const url = URL.createObjectURL(wavBlob);
                    const audio = new Audio(url);
                    audio.play();
                    audio.onended = () => {
                        setIsSpeaking(false);
                        URL.revokeObjectURL(url);
                    };
                } catch (err) {
                    setIsSpeaking(false);
                }
            };

            const pcmToWav = (base64Pcm, sampleRate) => {
                const pcmBuffer = Uint8Array.from(atob(base64Pcm), c => c.charCodeAt(0)).buffer;
                const header = new ArrayBuffer(44);
                const view = new DataView(header);
                const writeString = (o, s) => { for (let i=0; i<s.length; i++) view.setUint8(o+i, s.charCodeAt(i)); };
                writeString(0, 'RIFF');
                view.setUint32(4, 36 + pcmBuffer.byteLength, true);
                writeString(8, 'WAVE');
                writeString(12, 'fmt ');
                view.setUint32(16, 16, true);
                view.setUint16(20, 1, true);
                view.setUint16(22, 1, true);
                view.setUint32(24, sampleRate, true);
                view.setUint32(28, sampleRate * 2, true);
                view.setUint16(32, 2, true);
                view.setUint16(34, 16, true);
                writeString(36, 'data');
                view.setUint32(40, pcmBuffer.byteLength, true);
                return new Blob([header, pcmBuffer], { type: 'audio/wav' });
            };

            const onFileSelect = (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (ev) => {
                        setOriginalImage(ev.target.result);
                        setProcessedImage(null);
                        setGeneratedWishes("");
                        applyHoliTransformation(ev.target.result);
                        editorRef.current?.scrollIntoView({ behavior: 'smooth' });
                    };
                    reader.readAsDataURL(file);
                }
            };

            return (
                <div className="min-h-screen pb-20">
                    {/* ‡§®‡•á‡§µ‡§ø‡§ó‡•á‡§∂‡§® ‡§¨‡§æ‡§∞ */}
                    <nav className={`fixed top-0 w-full z-50 transition-all duration-500 px-6 py-4 ${scrolled ? 'bg-black/90 backdrop-blur-xl border-b border-white/10 shadow-lg' : 'bg-transparent'}`}>
                        <div className="max-w-7xl mx-auto flex justify-between items-center">
                            <div className="flex items-center gap-3">
                                <div className="w-12 h-12 bg-gradient-to-tr from-[#ff0080] to-[#7928ca] rounded-2xl flex items-center justify-center font-black text-2xl italic shadow-xl text-white">H</div>
                                <span className="text-2xl font-black tracking-tighter italic uppercase">‡§π‡•ã‡§≤‡•Ä<span className="text-[#ff0080]">PRO</span></span>
                            </div>
                            <button 
                                onClick={() => fileInputRef.current.click()}
                                className="bg-gradient-to-r from-[#ff0080] to-[#ff8c00] text-white px-8 py-3 rounded-full font-bold text-sm btn-glow transition-all active:scale-95 shadow-lg uppercase tracking-wider"
                            >
                                ‡§π‡•ã‡§≤‡•Ä ‡§Æ‡§®‡§æ‡§è‡§Ç üéâ
                            </button>
                        </div>
                    </nav>

                    {/* ‡§π‡•Ä‡§∞‡•ã ‡§∏‡•á‡§ï‡•ç‡§∂‡§® */}
                    <header className="relative pt-48 pb-32 px-6 flex flex-col items-center text-center">
                        <div className="inline-flex items-center gap-2 px-6 py-2 rounded-full bg-white/5 border border-white/10 mb-12 animate-pulse">
                            <span className="w-2.5 h-2.5 rounded-full bg-[#ff0080]"></span>
                            <span className="text-xs font-bold tracking-[0.4em] uppercase text-gray-300">Next-Gen AI Edition 2026</span>
                        </div>
                        
                        <h1 className="text-7xl md:text-[12rem] font-black mb-10 leading-[0.8] tracking-tighter italic uppercase drop-shadow-2xl">
                            RANGON KA <br />
                            <span className="text-gradient">MAGIC</span>
                        </h1>
                        
                        <p className="text-gray-400 max-w-2xl text-lg md:text-2xl font-medium mb-16 leading-relaxed">
                            ‡§∏‡§ø‡§∞‡•ç‡§´ ‡§è‡§ï ‡§´‡•ã‡§ü‡•ã ‡§Ö‡§™‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ ‡§¶‡•á‡§ñ‡•á‡§Ç ‡§ï‡•à‡§∏‡•á ‡§è‡§Ü‡§à ‡§â‡§∏‡•á ‡§è‡§ï ‡§∂‡§æ‡§®‡§¶‡§æ‡§∞ ‡§π‡•ã‡§≤‡•Ä ‡§∏‡•á‡§≤‡§ø‡§¨‡•ç‡§∞‡•á‡§∂‡§® ‡§Æ‡•á‡§Ç ‡§¨‡§¶‡§≤ ‡§¶‡•á‡§§‡§æ ‡§π‡•à‡•§
                        </p>

                        <div className="flex flex-col items-center gap-14">
                            {/* ‡§ú‡§æ‡§¶‡•Å‡§à ‡§´‡•ã‡§ü‡•ã ‡§´‡•ç‡§∞‡•á‡§Æ */}
                            <div 
                                onClick={() => fileInputRef.current.click()}
                                className="magic-frame w-80 h-80 md:w-[450px] md:h-[450px] cursor-pointer group hover:scale-105 transition-transform"
                            >
                                <div className="frame-content w-full h-full flex flex-col items-center justify-center bg-[#050505] rounded-[2rem] border border-white/5">
                                    <div className="text-8xl mb-8 group-hover:scale-110 transition-transform drop-shadow-lg">üì∏</div>
                                    <h3 className="text-2xl font-black text-white mb-3 tracking-wide uppercase italic">‡§´‡•ã‡§ü‡•ã ‡§Ø‡§π‡§æ‡§Å ‡§ú‡•ã‡•ú‡•á‡§Ç</h3>
                                    <p className="text-gray-500 text-[11px] uppercase tracking-[0.3em] px-10 text-center text-wrap opacity-60">‡§è‡§Ü‡§à ‡§Ö‡§™‡§®‡•á ‡§Ü‡§™ ‡§∞‡§Ç‡§ó ‡§≤‡§ó‡§æ‡§è‡§ó‡§æ ‡§î‡§∞ ‡§∂‡§æ‡§Ø‡§∞‡•Ä ‡§≤‡§ø‡§ñ‡•á‡§ó‡§æ</p>
                                </div>
                            </div>

                            <button 
                                onClick={() => fileInputRef.current.click()}
                                className="bg-white text-black px-16 py-6 rounded-[3rem] font-black text-3xl flex items-center gap-5 hover:bg-[#ff0080] hover:text-white transition-all shadow-2xl btn-glow uppercase tracking-tighter"
                            >
                                ‡§ú‡§æ‡§¶‡•Ç ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç ‚ú®
                            </button>
                            <input type="file" ref={fileInputRef} onChange={onFileSelect} className="hidden" accept="image/*" />
                        </div>
                    </header>

                    {/* ‡§è‡§°‡§ø‡§ü‡§ø‡§Ç‡§ó ‡§µ‡§∞‡•ç‡§ï‡§∏‡•ç‡§™‡•á‡§∏ */}
                    <section ref={editorRef} className="py-24 px-6 relative z-10 scroll-mt-24 max-w-7xl mx-auto">
                        {originalImage && (
                            <div className="glass-panel rounded-[5rem] p-10 md:p-20 border border-white/5 shadow-3xl fade-up">
                                <div className="grid lg:grid-cols-2 gap-20 items-start">
                                    {/* ‡§ë‡§∞‡§ø‡§ú‡§ø‡§®‡§≤ ‡§´‡•ã‡§ü‡•ã */}
                                    <div className="space-y-8 w-full">
                                        <div className="flex items-center gap-4">
                                            <span className="w-12 h-1 bg-gray-700"></span>
                                            <h2 className="text-3xl font-black italic tracking-tight uppercase opacity-40">Original View</h2>
                                        </div>
                                        <div className="rounded-[4rem] overflow-hidden border border-white/5 opacity-30 grayscale shadow-inner">
                                            <img src={originalImage} className="w-full aspect-[4/5] object-cover" alt="Original" />
                                        </div>
                                    </div>

                                    {/* ‡§Æ‡•à‡§ú‡§ø‡§ï ‡§∞‡§ø‡§ú‡§≤‡•ç‡§ü */}
                                    <div className="space-y-10 w-full">
                                        <div className="flex items-center gap-4">
                                            <span className="w-12 h-1 bg-pink-600"></span>
                                            <h2 className="text-3xl font-black italic tracking-tight uppercase text-[#ff0080]">Magic Result</h2>
                                        </div>
                                        <div className="magic-frame aspect-[4
